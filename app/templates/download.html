<style>
  #prog {
    width: 400px;
    border: 1px solid red;
    height: 20px;
  }
  #bar {
    width: 0px;
    background-color: blue;
    height: 20px;
  }
</style>
<h3>Image Croping</h3>
<div id="imgpl">Image not ready. Please wait.</div>
<div id="wrapper">
  <div id="prog"><div id="bar"></div></div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.3/socket.io.js"></script>
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>

<!-- ------------------------------- -->
<!-- Old Code -->
<!-- ------------------------------- -->

<!-- <script>

var end_file;
  function poll() {
      $.ajax("{{url_for('.progress', jobid=JOBID)}}", {
          dataType: "json"
          , success: function(resp) {
              $("#bar").css({width: $("#prog").width() * resp.progress});
              if(resp.progress >= 0.99) {
                  $("#wrapper").html('');
                  $.get("result.png?jobid={{JOBID}}", function(data, status){
                    end_file=data;
                    $("#imgpl").html('<img src='+end_file+'>');
                    console.log("success")
                    });           
                  return;
              } else {
                  setTimeout(poll, 500.0);
              }
  
          }
      });
  
  }


  
  $(function() {
      var JOBID = "{{ JOBID }}";
      poll();
  
  });
  </script> -->

<script>
  var socket = io.connect("http://" + document.domain + ":" + location.port);

  socket.on("message_response", function (msg) {
    // socket.join('room1');
    console.log(msg);
    // io.to('room1').emit('some event');
  }); // code to listen to socket message in JS

  //   socket.emit("message", {
  //     foo: "bar",
  //     some: "message",
  //   });
  // code to emit socket message in JS

  socket.on("connect", function () {
    console.log("client connect");
    socket.emit("testing", { message: "test" });
  });
</script>
